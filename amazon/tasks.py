from celery import shared_task
import json
import os
from pathlib import Path
from dotenv import load_dotenv
import subprocess
import psutil
import signal
from psutil import process_iter, NoSuchProcess, AccessDenied, ZombieProcess
import redis
from .models import ProductService, DomainExchangeRate
import requests
import logging
from celery.signals import after_setup_logger


BASE_DIR = Path(__file__).resolve().parent.parent
APP_DIR = Path(__file__).resolve().parent
load_dotenv(os.path.join(BASE_DIR, '.environ'))
is_server = bool(os.getenv('IS_SERVER').lower() == 'true')
EXCHANGERATE_API_KEY = os.getenv('EXCHANGERATE_API_KEY')

logger = logging.getLogger(__name__)

# https://www.google.com/search?q=&oq=&uule=w+CAIQICINVW5pdGVkIFN0YXRlcw&hl=en&gl=us&sourceid=chrome&ie=UTF-8


DOMAIN_IDS = [1, 2, 6]
KEEPA_API_KEY = "6rmn50bac4v5u8ik7e085nbmoqh7rtr2lip8gtt47012bv8uvdnm3alcijrkvlg6"
PRODUCT_ASINS = [
    "B07N7PK9QK",
    "B001CJVTLC",
    "B0030HBU6I",
    "B07X8Y24HR",
    "B00BUB7TM0",
    "B00PBX3L7K",
    "B001PBW4FW",
    "B01D58BGTM",
    "B00006IBNJ",
    "B077GT29HM",
    # "B0795GHTBC",
    # "B09GHV6G55",
    # "B093H199FN",
    # "B08VNCCXWJ",
    # "B0196T9VCI",
    # "B07BTY75CV",
    # "B004NOR566",
    # "B08TZY61DP",
    # "B09XCWWVCW",
    # "B07H1DHJBV",
    # "B07SRK1F3Y",
    # "B09CTB3M1T",
    # "B07CZWYY4H",
    # "B081XDZ6LL",
    # "B09238Y3KR",
    # "B01B6FBG0K",
    # "B07R8M3VY5",
    # "B0BNBY4KMX",
    # "B071XNBL33",
    # "B09YJY3X2D",
    # "B07X48WNRT",
    # "B0BX8TS5Y8",
    # "B00005LBVS",
    # "B09RFBX42Y",
    # "B09MDYMWM9",
    # "B08K3ZRPKD",
    # "B00005QDTF",
    # "B007OYLNGA",
    # "B09MN16RDT",
    # "B09P517WHB",
    # "B088D5JNSN",
    # "B014SAB948",
    # "B07K5QVJV3",
    # "B01LDWMGNC",
    # "B008B19HQS",
    # "B015IY34FA",
    # "B097D7XKKZ",
    # "B00428CCPW",
    # "B092MP3GYB",
    # "B06W5JYQX1",
    # "B07HR21CD5",
    # "B0732MD43P",
    # "B07HQ3Z1D1",
    # "B000HZDYAG",
    # "B0BGMJFQ82",
    # "B08VWWZ5GS",
    # "B002YC83MO",
    # "B009LI7VRC",
    # "B07RT23SKN",
    # "B08Z1YVNHT",
    # "B08NC6SS11",
    # "B08CBK34RL",
    # "B08HJXRB1K",
    # "B08ZNRV8VZ",
    # "B09SVK9YBB",
    # "B07SQZ3GJG",
    # "B075S8V728",
    # "B09MW99PCL",
    # "B09VDTL378",
    # "B08K42G7SH",
    # "B0B866CWSV",
    # "B08QVF65DB",
    # "B07DYSR1QH",
    # "B083PWR5KY",
    # "B075X1KPLZ",
    # "B01D0Q7JU4",
    # "B07HJB9MCC",
    # "B09BJFHQYJ",
    # "B00536OCYG",
    # "B0163TTCL4",
    # "B08PMV3741",
    # "B0B3SDR81S",
    # "B08RLLJ8MF",
    # "B000I9RZOW",
    # "B000091NSL",
    # "B01JUMUPGW",
    # "B0829FT44S",
    # "B000AXSFZY",
    # "B09GLH9SCQ",
    # "B0B28YKFN4",
    # "B0785SFKYF",
    # "B098Z4NX7P",
    # "B08VF96DNP",
    # "B096VYT8X6",
    # "B098YXCY64",
    # "B09GK7Z1GX",
    # "B098Z3J5BW",
    # "B08RLS83JH",
    # "B014HNOXZS",
    # "B07978VPPH",
    # "B07N5LMSN8",
    # "B0743KVCJC",
    # "B00160359G",
    # "B08PQCW529",
    # "B08R9X7Q6C",
    # "B07V5LZMTH",
    # "B01AASAM7M",
    # "B0B2X1YX72",
    # "B00LG07QZA",
    # "B071FNYFWW",
    # "B09ZXCRS5B",
    # "B07X3HTTNT",
    # "B01HTAOZTK",
    # "B01B6FBHV8",
    # "B08VF7XCZ1",
    # "B019MOCBCY",
    # "B08ZJNVMLP",
    # "B00D82Z4YO",
    # "B07KQWXRGM",
    # "B01DALGSVA",
    # "B01AQ6OWAG",
    # "B08X3QN5Y3",
    # "B09LWRN1BN",
    # "B09DGPRM22",
    # "B071RMS3PS",
    # "B07ZHW7ZXX",
    # "B09R316LTX",
    # "B07DXGYHSD",
    # "B00LKPM39A",
    # "B07GSX78CW",
    # "B0BDYWXV6L",
    # "B000V2FBAQ",
    # "B0B9YR7FSJ",
    # "B01N1T0EGN",
    # "B073YHQ5ZD",
    # "B01NCP64T0",
    # "B00PR2IC8I",
    # "B003U4YC70",
    # "B01CUF9DVY",
    # "B07H9L8JRV",
    # "B08VCZRLRL",
    # "B07TNJRN9N",
    # "B09TNLB437",
    # "B096SK949M",
    # "B00001R3W3",
    # "B0BFWRKK8R",
    # "B0040HG4AE",
    # "B01N6QBJG0",
    # "B07L9MBLYP",
    # "B07SV4WDHK",
    # "B08GZ4Z5SM",
    # "B07P11F21N",
    # "B01LC98QEE",
    # "B0007OY3UC",
    # "B07NSMQGPV",
    # "B00004XP35",
    # "B08GJBQMZD",
    # "B07DHYH95R",
    # "B00LTZEEGQ",
    # "B0BJLD36TT",
    # "B07GKWLBN2",
    # "B08H7139X2",
    # "B07S6FDHPN",
    # "B0B781V95J",
    # "B00LQCB6I6",
    # "B0BF9PQ1YH",
    # "B000JLI0K2",
    # "B009NT0I06",
    # "B082CCGYF1",
    # "B07RT8Y122",
    # "B09C5RTFRM",
    # "B00LZSJ642",
    # "B08TTCRD89",
    # "B005FWLO44",
    # "B07T86DNTD",
    # "B000BQWWJK",
    # "B07QF2SN7D",
    # "B0BRBTFXJ5",
    # "B07SMMBY4R",
    # "B08ZNJBQKQ",
    # "B018REM7II",
    # "B0BR7MKHF9",
    # "B08D1VF18M",
    # "B09PQ95GY4",
    # "B07C91PXNM",
    # "B00GRSWXQI",
    # "B07RYFWYGC",
    # "B095DCY459",
    # "B01BFX28R8",
    # "B0064PQOSC",
    # "B07TB1KW7S",
    # "B0B86KKBN2",
    # "B07PLLZD78",
    # "B07HTFD1SG",
    # "B00HX2QDV8",
    # "B074KZSVD6",
    # "B0B6CKG1MH",
    # "B06XF4GPQP",
    # "B09BMQH55C",
    # "B086379CHH",
    # "B08YW13SG3",
    # "B01M65RD19",
    # "B08K2Y2KQN",
    # "B094GCJK7V",
    # "194975944X",
    # "B00YV5FF32",
    # "B09BDQ2FRY",
    # "B005PTNVM0",
    # "B00WV7TQDW",
    # "B0BB6Y1RJV",
    # "B06Y2NHXVP",
    # "B004TRKHSK",
    # "B08SXLWXH9",
    # "B00RSXRLUE",
    # "B005W3BR2A",
    # "B0883S8GW7",
    # "B000SWVPV8",
    # "B01MYBZ4A9",
    # "B07NLL718P",
    # "B01N6QPWBV",
    # "B00JTF5TT4",
    # "B09S77J9TX",
    # "B08BFD54YW",
    # "B00PA04SD0",
    # "B093K7K35T",
    # "B00YNSZCXA",
    # "B096MLRDRZ",
    # "B091BCL2YB",
    # "B0C56RLLYN",
    # "B07R68XHZ9",
    # "B07BSWN5SP",
    # "B089KL3FDD",
    # "B00M3IFUMK",
    # "B08NRS3YP8",
    # "B078YZDW2X",
    # "B0043B7UQY",
    # "B0779YGB2G",
    # "B07Y8PVTX5",
    # "B06XGYXVXR",
    # "B07R29YTRG",
    # "B00BTJTYB2",
    # "B00JDOCW3M",
    # "B000056BAG",
    # "B08883B54R",
    # "B00NE4ZU5O",
    # "B00PRABXFO",
    # "B06W5WP5KL",
    # "B08F65S419",
    # "B07HC2F97Q",
    # "B072N1JWJ9",
    # "B0BNNYPVYR",
    # "B00YR922ZG",
    # "B01HF1Z5WY",
    # "B00BUBAPQC",
    # "B08RHR1WZK",
    # "B08YDQQ6W6",
    # "B00BPXN10C",
    # "B081P1538H",
    # "B0BP46PVVG",
    # "B09MQGTP7Y",
    # "B09T9DQTTR",
    # "B002G24HD6",
    # "B003O6E800",
    # "B0001ZVXJQ",
    # "B078GYC6QN",
    # "B01LWM61BE",
    # "B07M9BKHNZ",
    # "B08MVDTLKC",
    # "B07TC8J6HK",
    # "B08W9C5TSQ",
    # "B0798SCGQJ",
    # "B07RG35NZR",
    # "B00F5YTHYQ",
    # "B0108L0QHM",
    # "B08W7KSMVV",
    # "B07T8F2RKB",
    # "B007TA5QNA",
    # "B08VW5974C",
    # "B01KNFI86E",
    # "B09FB1YXF1",
    # "B01M31YZPX",
    # "B00290NPTM",
    # "B0BNT2LDWK",
    # "B07DL2FKS2",
    # "B0B6CFX35R",
    # "B00DY1F2CS",
    # "B000E1TJDE",
    # "B08V23DZVC",
    # "B01N303YPU",
    # "B074G79614",
    # "B01DOZRZHI",
    # "B09PHP2452",
    # "B0BF622HFH",
    # "B01N4NTNO2",
    # "B0000032ZW",
    # "B07RC8KSWK",
    # "B00061Q83Q",
    # "B08MHZQQ56",
    # "B01N7TGKYE",
    # "B001Q5GOE4",
    # "B0002BQMYA",
    # "B093L2FJRJ",
    # "B004TS06HG",
    # "B000R5PKD0",
    # "B001DPC4SM",
    # "B0BGT56H26",
    # "B00RSB6I1E",
    # "B09T82QQZY",
    # "B084KZ2CG1",
    # "B07P7834WM",
    # "B07H3NV9JS",
    # "B00B3BVRHK",
    # "B00UGQ1RA0",
    # "B083XSZLGD",
    # "B096LMV352",
    # "B00NU6VN6G",
    # "B004YD769C",
    # "B07DG77KPX",
    # "B07FL1FD47",
    # "B07PDNLH8C",
    # "B07XLQD1ZV",
    # "B084ZBY221",
    # "B08GZ3DRLW",
    # "B00J5K670S",
    # "B0B61KWTYP",
    # "B00L2EHNJY",
    # "B01NBK9GPA",
    # "B08Y7C6H2F",
    # "B00TGTVVMW",
    # "B00SEYOWIA",
    # "B01K5YKEA6",
    # "B08CLD2Z4K",
    # "B07RB2HTB2",
    # "B07JJJGWJB",
    # "B004LQSNE4",
    # "B01N6QLRPU",
    # "B07GC99X4K",
    # "B00BG1IOC8",
    # "B0B3CLP6K5",
    # "B084GFNBM9",
    # "B06XDPTDN5",
    # "B0BJC6FMPT",
    # "B00HFXBD74",
    # "B00L1UEZS6",
    # "B08DN2FHDY",
    # "B0BZQY844F",
    # "B0BF9L5CK8",
    # "B01JYFHR8O",
    # "B00ND0E7BW",
    # "B08G4GRQYV",
    # "B07D8494WV",
    # "B088JVTV1K",
    # "B014H8AWGC",
    # "B08YJPJLFV",
    # "B000F3HK78",
    # "B0B12R84W3",
    # "B0BLQJG2Z8",
    # "B00HW2VR74",
    # "B0783Q64XC",
    # "B00AMAHL7S",
    # "B07X7WLCJ5",
    # "B09X8P426M",
    # "B08BN2BL25",
    # "B08P2CF98Y",
    # "B09K4SG9J5",
    # "B08P2FZ89X",
    # "B09K4V3DHL",
    # "B08P2FP52M",
    # "B08P2C4FXF",
    # "B08P2HGYRL",
    # "B08P2D5MWP",
    # "B08P2CHKY8",
    # "B08P2FFQRP",
    # "B00387BTJS",
    # "B08P2F1WYP",
    # "B08P2J1DR2",
    # "B08P2F6S1Z",
    # "B09K4T793W",
    # "B09K4W1LXH",
    # "B08P2DLZKB",
    # "B08P2F6817",
    # "B08BN4RFLB",
    # "B0817HJ314",
    # "B08P2D6T18",
    # "B0817DXBQ7",
    # "B08BN4QK9K",
    # "B08P2DDB9Y",
    # "B0009Q2PE4",
    # "B09W5ZQQ1W",
    # "B00KD6YW46",
    # "B01JOB636K",
    # "B007FHGZHS",
    # "B093QJFWDX",
    # "B08P2CD3QX",
    # "B08BMHDYYK",
    # "B08BMQVZF2",
    # "B08P2D8S24",
    # "B0817FGBDG",
    # "B09TRTDSKM",
    # "B011PK0CFQ",
    # "B000COCUF2",
    # "B00171PYIO",
    # "B01NCZVOB3",
    # "B01N9FIELY",
    # "B00Q3F0ITO",
    # "B01M9ISOHV",
    # "B085FYHK3H",
    # "B00O59SH3E",
    # "B08P2GGPMW",
    # "B00TWCMDQQ",
    # "B09B6ZBWZH",
    # "B01MSYK947",
    # "B086L88DKH",
    # "B091BD6KJR",
    # "B09PR8NBZZ",
    # "B06WW9SJ5M",
    # "B08W3QKDRT",
    # "B0BL4KLKK6",
    # "B084TC9T4X",
    # "B08LZJ8GMH",
    # "B003H54TY8",
    # "B00EIMRZGS",
    # "B08X2HNT4D",
    # "B084BGC5LR",
    # "B003W0GFTU",
    # "B07GW3YK17",
    # "B0024396WY",
    # "B01N2VB05L",
    # "B00004UE4F",
    # "B09V1MX8XG",
    # "B0BFBNMSXS",
    # "B0002GYX5K",
    # "B000RSICZU",
    # "B07RMK4661",
    # "B09V6TBNMC",
    # "B00L59D9HG",
    # "B07N4BSRWR",
    # "B00Q3F0GG4",
    # "B00CQ7OV1E",
    # "B000ARPVQ6",
    # "B00KX01L28",
    # "B06XXCHNM7",
    # "B07YN9JXNW",
    # "B000RVYRC4",
    # "B09M5ZS9K5",
    # "B091TVHTD3",
    # "B01JVDK8K8",
    # "B00C4TSVZG",
    # "B09K3DBL38",
    # "B017J293OU",
    # "B00SYXDGPG",
    # "B0BVBWCW9X",
    # "B07V3G6C1F",
    # "B09C6KMN6L",
    # "B009I2UC3Q",
    # "B0983SKFXT",
    # "B000XZXE50",
    # "B098HH48VX",
    # "B07BKR77N6",
    # "B079X4DB3J",
    # "B07VJ539YP",
    # "B000P0J024",
    # "B0786N1335",
    # "B09PSKW8LH",
    # "B0B77BSPFH",
    # "B01N8UJO9W",
    # "B000E11220",
    # "B008304KEG",
    # "B0BG99WLR9",
    # "B07XLVNBNB",
    # "B010MHV2AC",
    # "B09G1WD2CG",
    # "B087B8KZLB",
    # "B087CCVD5D",
    # "B07RNFZ9KT",
    # "B08DKVZCBC",
    # "B01IABP0MI",
    # "B08KVGSXFB",
    # "B003ERQWD0",
    # "B0BCFQY7ZY",
    # "B00B2CCA6W",
    # "B07NSSHPFN",
    # "B017X8GL9A",
    # "B071NHCKHT",
    # "B01ABVLOHA",
    # "B08CK9QQMH",
    # "B09G61NKC3",
    # "B01KYRUBT8",
    # "B0BMZVSRV1",
    # "B00Q4ER810",
    # "B00003002L",
    # "B001B9SL50",
    # "B079JCLZ5C",
    # "B01AO5FFIM",
    # "B016TV9IOM",
    # "B01MQ0IP8F",
    # "1999572068",
    # "B018Z6LNHE",
    # "B00536OCZK",
    # "B0716SP956",
    # "B00O9GPEDO",
    # "B08B3K9K6P",
    # "B01N3489RH",
    # "B08JJLVWH6",
    # "B0095GVWMA",
    # "B097F6916C",
    # "B091NJQ29P",
    # "B0B35945XG",
    # "B00D7WWOES",
    # "B00415UVTK",
    # "B07YVTZXDT",
    # "B011J54UEG",
    # "B004ZN9UZO",
    # "B008LXZZ4E",
    # "B0044A2CK8",
    # "B09V26WZ1D",
    # "B001B26II4",
    # "B00QW2BMH0",
    # "B073BMRPCP",
    # "B002Y6B4A8",
    # "B08CYCDJXR",
    # "B077898C1R",
    # "B0B2X4BMV2",
    # "B0013D53CS",
    # "B01BF8DYKI",
    # "B098TV2ZS3",
    # "B08Y1JQZBZ",
    # "B01NASUGOS",
    # "B08X3JV8YR",
    # "B07V6T1MH8",
    # "B07F8WHNB7",
    # "B0BZ3BBQ89",
    # "B00K7003B4",
    # "B002VLH7AW",
    # "B089DLFCC1",
    # "B01LYU5S6D",
    # "B01BEUL5T4",
    # "B078MKY7B9",
    # "B07B61GLRW",
    # "B01N7BTWEN",
    # "B008GYYFR6",
    # "B00JDOZB6C",
    # "B075PTHVKN",
    # "B09479VYD7",
    # "B071P4PZBH",
    # "B09BZZ311F",
    # "B00NCAO9SO",
    # "B000BRNBZ8",
    # "B00HWX26G4",
    # "B07L73DW8M",
    # "B087R8H9XB",
    # "B07L1C28N9",
    # "B0B4GP9M1T",
    # "B00B5U9IFC",
    # "B07NBVM9PG",
    # "B0BC8YRJPR",
    # "B0161C43RQ",
    # "B00B4H6KUM",
    # "B09FK5SQGP",
    # "B01MSUMVUB",
    # "B09J4BP466",
    # "B075MYT126",
    # "B078SFLTJQ",
    # "B098K7SD3P",
    # "B00CKYGN3W",
    # "B073NP1VGZ",
    # "B09QR6MX9V",
    # "B0B1LB15CH",
    # "B072QN7FWK",
    # "B0BVFL5NP1",
    # "B077B7TYPL",
    # "B091T4BM9M",
    # "B01N8QNC59",
    # "B07QD7KXZ8",
    # "B00M0S7F8K",
    # "B08CXHHLWS",
    # "B01K0AOHJ4",
    # "B074M13TBY",
    # "B0B3DTK6YK",
    # "B08WLJN3W7",
    # "B07HKC1J8Q",
    # "B09TC1F9GF",
    # "B0BSZ23FTF",
    # "B07P1GD7NK",
    # "B08W63D82J",
    # "B00F5P1DVA",
    # "B076HCJPS4",
    # "B093QDR594",
    # "B0C2CCGT4Y",
    # "B09B8P794R",
    # "B095Y1TDNV",
    # "B09X4GSGSC",
    # "B0842BM7JN",
    # "B08KLGWXF3",
    # "B0977SFJ9H",
    # "B07V3SZ43Y",
    # "B09G75RWN2",
    # "B01NAAWOGO",
    # "B000GCS004",
    # "B07CBF8ZHL",
    # "B01EA91TI8",
    # "B006XBSAP2",
    # "B0775Z5443",
    # "B07G9JMTS2",
    # "B08JHP4Q82",
    # "B084RNLPGR",
    # "B07RNKY499",
    # "B07HDK9T7B",
    # "B09GYK95BL",
    # "B001RNMEEE",
    # "B07JZDF7JN",
    # "B09THDXJ33",
    # "B013M4COAE",
    # "B01N33U6Y5",
    # "B002L3TS5M",
    # "B093CQCPTH",
    # "B0002D0L5E",
    # "B08CZ89J15",
    # "B0786Q2RFJ",
    # "B07DGGCG69",
    # "B07VMXTRQ7",
    # "B07KZZGNFX",
    # "B071VTCWXN",
    # "B09WZ4ZH5Z",
    # "B00B4H6IKY",
    # "B0929CDQBX",
    # "B07GVXD8J2",
    # "B00O1GFHQ6",
    # "B00MW4H190",
    # "B012BUM5V8",
    # "B0045K2U0E",
    # "B01MDUYET2",
    # "B093TPP32X",
    # "B01N5K834V",
    # "B07NVVT8DF",
    # "B0BV1L1TY2",
    # "B07Y57WH9H",
    # "B07D7HQQLH",
    # "B006CVXR10",
    # "B07MH34HP4",
    # "B073SDKTL5",
    # "B00B5VTJJ6",
    # "B08DB49XRR",
    # "B00I913SWE",
    # "B07P2HV7XQ",
    # "B07QW9159N",
    # "B07LCLG1T7",
    # "B0002C4GU6",
    # "B091QB91X2",
    # "B07HNT8SQL",
    # "B09L6MPWN3",
    # "B084L18WH9",
    # "B0859XX6HC",
    # "B01MQYAOK4",
    # "B008XB1C0A",
    # "B084GRS9JB",
    # "B01DCYWI96",
    # "B003NR57BY",
    # "B089RD7F71",
    # "B00LRKJV1Q",
    # "B01I2MLN2Q",
    # "B07342ZTT4",
    # "B0BWYMYM4F",
    # "B08YJ3J221",
    # "B0BKRHP7H4",
    # "B008AITI52",
    # "B092MGLRY8",
    # "B00PMKOI06",
    # "B0098WV8F2",
    # "B002UAKLM0",
    # "B01MFGALN9",
    # "B00W2D806Y",
    # "B09NXS395V",
    # "B00AT9Q38K",
    # "B01FURLH40",
    # "B09GL3VXF1",
    # "B003BUCNNS",
    # "B01GWBULHW",
    # "B08PJNXYWB",
    # "B015KY5J7Y",
    # "B09BNMWJH9",
    # "B00ELSOLAC",
    # "B0184FR81G",
    # "B0054Y0KGQ",
    # "B083JVPGMY",
    # "B00OS47EDK",
    # "B0915CMY57",
    # "B0BCMBHVWD",
    # "B0053B66KE",
    # "B00Z642JM2",
    # "B095HZ9D8B",
    # "B074K9HJRB",
    # "B08FV3CTVN",
    # "B0BK8SPMCL",
    # "B09CZT15ZP",
    # "B07CZSN425",
    # "B07D42ZV9D",
    # "B0BYZFY3WZ",
    # "B08PW55J48",
    # "B007PDBHBG",
    # "B074CHCY28",
    # "B07RY4RXLV",
    # "B084JBLFXS",
    # "B07QF4T64V",
    # "B09HBYQ944",
    # "B00DLLGRCA",
    # "B01AB6UOW6",
    # "B0010TEFFQ",
    # "B08M2HRV2W",
    # "B08Q82S2GD",
    # "B00I51885U",
    # "B00X04OKLI",
    # "B00027930Y",
    # "B002FTP112",
    # "B013FDBGWO",
    # "B07SG75NLY",
    # "B00U7WKAQA",
    # "B072LRHFTM",
    # "B099KMZPMZ",
    # "B012KCIWKA",
    # "B000F09CF4",
    # "B000002LV3",
    # "B09NB7XNVB",
    # "B075NC2MYB",
    # "B005JZVJMO",
    # "B003SPUIAG",
    # "B088YM52MF",
    # "B005ESIHZI",
    # "B083T65GQX",
    # "B01GJ826F8",
    # "B0065M5GJ2",
    # "B0129HZM7W",
    # "B0B99LBSY9",
    # "B00MNS2L4A",
    # "B0979LJBQJ",
    # "B072Q7PN7H",
    # "B07PQCGMCK",
    # "B009ERCFGM",
    # "B005NFJAQC",
    # "B01CH74RF2",
    # "B01C95I8N4",
    # "B086N314TX",
    # "B00HSSZKAW",
    # "B07JB3WQLV",
    # "B005LM09QM",
    # "B0773JVKNM",
    # "B08JWKRGN8",
    # "B08K2PR9CF",
    # "B00MZD6MIE",
    # "B01L4JNR0U",
    # "B08C1T4KQM",
    # "B007EFW3XQ",
    # "B0819WNFMS",
    # "B07P62MLMM",
    # "B00ME3Q07S",
    # "B0BF5812N3",
    # "B000068G5F",
    # "B0968ZWZKD",
    # "B09GL2YQ2S",
    # "B07B3K47LZ",
    # "B07QYGXJ67",
    # "B08THFYBDD",
    # "B08CS7BJ18",
    # "B09SMJG53B",
    # "B07TW2FYNV",
    # "B07HDBZN7Q",
    # "B081QN6KRK",
    # "B07BRC62Z4",
    # "B00PP3FSDG",
    # "B000HHQ7WQ",
    # "B00MC8LJQ2",
    # "B01MUCC1KI",
    # "B07GCDKPJJ",
    # "B09DNL4C9J",
    # "B07MF42ZK9",
    # "B07CNDCZ1C",
    # "B08XWDXLGQ",
    # "B00S7RZX28",
    # "B07BHGT42W",
    # "B07VBYH2BC",
    # "B08WJPS6KY",
    # "B003LZPJK2",
    # "B00HXT8MNI",
    # "B08WM2WLL9",
    # "B07HC15QNZ",
    # "B08FCXZ2N3",
    # "B000002J1L",
    # "B00MS7GAXE",
    # "B08P7YXY4C",
    # "B07JMGR536",
    # "B0BV9NCWXL",
    # "B000N5MK8M",
    # "B0B6PWS4R5",
    # "B07SM4ZM33",
    # "B00VBVP30Y",
    # "B0B15SP7WZ",
    # "B00FIU0SCW",
    # "B01NBMPHYV",
    # "B00ZWMT2MS",
    # "B0000CFLYJ",
    # "B01GUVOXIW",
    # "B0BGMJWNW7",
    # "B002JI9502",
    # "B07K23HV61",
    # "B0005YX1NE",
    # "B07SJM2PXP",
    # "B00RH6R7C4",
    # "B01IYBJRPK",
    # "B007L5IB0I",
    # "B009GQ4QSQ",
    # "B07THZYFB4",
    # "B0BBZ1BWTT",
    # "B01BNWDLC2",
    # "B004EBS16G",
    # "B0BB22NF67",
    # "B082J4KSKC",
    # "B07Q5R22DV",
    # "B07CT8QF2V",
    # "B0C2QKQ2YR",
    # "B07CVMY79R",
    # "B0B6H1XN3F",
    # "B0BQWQMQQ8",
    # "B0019JDMU6",
    # "B07CX9TQNY",
    # "B09JVZPY8J",
    # "B0BD76BTSN",
    # "B07NGP9F4H",
    # "B005KBZTCI",
    # "B003VPC72K",
    # "B014VGZQOI",
    # "B0BBS1JM2X",
    # "B00S8LL17E",
    # "B08JVMXDP6",
    # "B000LPS4BG",
    # "B0BVMZNZPN",
    # "B0BDPL56VF",
    # "B000G7USPY",
    # "B07T8JVQ4K",
    # "B001NZO1DS",
    # "B07SGY6WSB",
    # "B08Y67HYZT",
    # "B000LNB8HK",
    # "B092LDK1DL",
    # "B001UOW7D8",
    # "B00GCAXW70",
    # "B09N7ZYJKM",
    # "B07XYHDMJ6",
    # "B013RJCAJO",
    # "B00KMV7KUU",
    # "B07XG6X4TC",
    # "B09MDXYS3S",
    # "B07DV6VWJ4",
    # "B00IS2V7LI",
    # "B06WLHBBZF",
    # "B001EQYYUG",
    # "B09CH97KJ8",
    # "B01DSZX6GI",
    # "B081ZXQVFH",
    # "B0BPRV5FGN",
    # "B07JQZN313",
    # "B08FCW2YX9",
    # "B01EC4V8P0",
    # "B00FEQREMW",
    # "B07BMKV6MT",
    # "B07HJ8MW1H",
    # "B002VWNIAY",
    # "B09V1KCLTX",
    # "B078B5N4DD",
    # "B000K41E6K",
    # "B0B94RMN17",
    # "B08VP1XCGK",
    # "B07D859X6X",
    # "B00HRVUVFY",
    # "B07HGSN1TH",
    # "B000F09CEA",
    # "B08CVR6FPH",
    # "B006NZRAFE",
    # "B09K7XFFMS",
    # "B00RGZ915C",
    # "B002VLH874",
    # "B09FBCRKC9",
    # "B00UGQ3SAC",
    # "B00ZGRMTLA",
    # "B00FFYQ29O",
    # "B0B2J5MD7N",
    # "B0973JRDBR",
    # "B089ZPKF16",
    # "B00MG4CVAU",
    # "B091NKW39H",
    # "B083NFNKY2",
    # "B0BX6CFWV8",
    # "B099N7PJBW",
    # "B0B9YSZ9D9",
    # "B001UJJG46",
    # "B0B9PZCY7N",
    # "B00FLJIMYG",
    # "B00MBVAEIO",
    # "B008I3CJI2",
    # "B099F7XF2Q",
    # "B00IPS4KIC",
    # "B08QVWDYTS",
    # "B01MSD3E6M",
    # "B00LFWM0H8",
    # "B018209X7U",
    # "B09PGXLS17",
    # "B06X17LJF9",
    # "B082M4MVFG",
    # "B06VXJ7BQR",
    # "B07VX947W1",
    # "B0764Z1BX4",
    # "B00ZPR8KW8",
    # "B08R11D8NJ",
    # "B08MDVNGJR",
    # "B0000CF8Q6",
    # "B00YU6C2DI",
    # "B081ZFXPWY",
    # "B08RMYR79C",
    # "B08V79CRMH",
    # "B07WMTZCBF",
    # "B01LC9A6M4",
    # "B0BJ7FH4MK",
    # "B0036CDX12",
    # "B004GDB7OA",
    # "B07FPGN4L4",
    # "B07FNVYGFL",
    # "B00004YA66",
    # "B07QZLWW4J",
    # "B07MZ8ZKSR",
    # "B00HK2YZ5C",
    # "B005G2OJX6",
    # "B017OECD7W",
    # "B00N5FA6WY",
    # "B074VH2VWV",
    # "B00O0A7X9M",
    # "B07TY8JPV9",
    # "B01GEGXP0K",
    # "B0741K4VDC",
    # "B00RH38G7M",
    # "B01MU03PEK",
    # "B07PXD6C85",
    # "B08FF8949Z",
    # "B01MT5L2Z8",
    # "B0141MQRGI",
    # "B07C3CRB4S",
    # "B07BHGNJ2V",
    # "B0BC79C96R",
    # "B07BQXYKGZ",
    # "B09TQZQHX6",
    # "B0B2KP6YJT",
    # "B07PW9KBBJ",
    # "B08ZDH9BDR",
    # "B0B5SSL6FL",
    # "B08RRYF52V",
    # "B07J6ZZ83K",
    # "B004X8GJPA",
    # "B000CST0L0",
    # "B000LC4ZBC",
    # "B0BCWVSPW8",
    # "B00UGPK8C4",
    # "B07C9D8STM",
    # "B07BYJF7L7",
    # "B00M5GYPLM",
    # "B09BDZCB7P",
    # "B015G849O8",
    # "B01LXC1QL0",
    # "B004CH81LM",
    # "B08C7PC1GM",
    # "B01AGMZ20O",
    # "B07289ZZVL",
    # "B09FT9GF3X",
    # "B07FXR67KP",
    # "B0055YU240",
    # "B09SV3G7GY",
    # "B088P7RDRR",
    # "B07JMHZMX1",
    # "B00PLIQULO",
    # "B09K8FH99X",
    # "B07QFHZZZL",
    # "B01MFXDAL8",
    # "B0832BYXB2",
    # "B0BHWWK431",
    # "B07BPCBMRJ",
    # "B07789HG6D",
    # "B0BRXR325K",
    # "B00CSL7NX6",
    # "B00DQD63NG",
    # "B086Q7Q6GJ",
    # "B07HGJLHSP",
    # "B079R427VR",
    # "B01MSHLUN1",
    # "B00AY6RO9U",
]


if is_server:
    PRODUCT_ASINS = [
    "B07N7PK9QK",
    "B001CJVTLC",
    "B0030HBU6I",
    "B07X8Y24HR",
    "B00BUB7TM0",
    "B00PBX3L7K",
    "B001PBW4FW",
    "B01D58BGTM",
    "B00006IBNJ",
    "B077GT29HM",
    "B0795GHTBC",
    "B09GHV6G55",
    "B093H199FN",
    "B08VNCCXWJ",
    "B0196T9VCI",
    "B07BTY75CV",
    "B004NOR566",
    "B08TZY61DP",
    "B09XCWWVCW",
    "B07H1DHJBV",
    "B07SRK1F3Y",
    "B09CTB3M1T",
    "B07CZWYY4H",
    "B081XDZ6LL",
    "B09238Y3KR",
    "B01B6FBG0K",
    "B07R8M3VY5",
    "B0BNBY4KMX",
    "B071XNBL33",
    "B09YJY3X2D",
    "B07X48WNRT",
    "B0BX8TS5Y8",
    "B00005LBVS",
    "B09RFBX42Y",
    "B09MDYMWM9",
    "B08K3ZRPKD",
    "B00005QDTF",
    "B007OYLNGA",
    "B09MN16RDT",
    "B09P517WHB",
    "B088D5JNSN",
    "B014SAB948",
    "B07K5QVJV3",
    "B01LDWMGNC",
    "B008B19HQS",
    "B015IY34FA",
    "B097D7XKKZ",
    "B00428CCPW",
    "B092MP3GYB",
    "B06W5JYQX1",
    "B07HR21CD5",
    "B0732MD43P",
    "B07HQ3Z1D1",
    "B000HZDYAG",
    "B0BGMJFQ82",
    "B08VWWZ5GS",
    "B002YC83MO",
    "B009LI7VRC",
    "B07RT23SKN",
    "B08Z1YVNHT",
    "B08NC6SS11",
    "B08CBK34RL",
    "B08HJXRB1K",
    "B08ZNRV8VZ",
    "B09SVK9YBB",
    "B07SQZ3GJG",
    "B075S8V728",
    "B09MW99PCL",
    "B09VDTL378",
    "B08K42G7SH",
    "B0B866CWSV",
    "B08QVF65DB",
    "B07DYSR1QH",
    "B083PWR5KY",
    "B075X1KPLZ",
    "B01D0Q7JU4",
    "B07HJB9MCC",
    "B09BJFHQYJ",
    "B00536OCYG",
    "B0163TTCL4",
    "B08PMV3741",
    "B0B3SDR81S",
    "B08RLLJ8MF",
    "B000I9RZOW",
    "B000091NSL",
    "B01JUMUPGW",
    "B0829FT44S",
    "B000AXSFZY",
    "B09GLH9SCQ",
    "B0B28YKFN4",
    "B0785SFKYF",
    "B098Z4NX7P",
    "B08VF96DNP",
    "B096VYT8X6",
    "B098YXCY64",
    "B09GK7Z1GX",
    "B098Z3J5BW",
    "B08RLS83JH",
    "B014HNOXZS",
    "B07978VPPH",
    "B07N5LMSN8",
    "B0743KVCJC",
    "B00160359G",
    "B08PQCW529",
    "B08R9X7Q6C",
    "B07V5LZMTH",
    "B01AASAM7M",
    "B0B2X1YX72",
    "B00LG07QZA",
    "B071FNYFWW",
    "B09ZXCRS5B",
    "B07X3HTTNT",
    "B01HTAOZTK",
    "B01B6FBHV8",
    "B08VF7XCZ1",
    "B019MOCBCY",
    "B08ZJNVMLP",
    "B00D82Z4YO",
    "B07KQWXRGM",
    "B01DALGSVA",
    "B01AQ6OWAG",
    "B08X3QN5Y3",
    "B09LWRN1BN",
    "B09DGPRM22",
    "B071RMS3PS",
    "B07ZHW7ZXX",
    "B09R316LTX",
    "B07DXGYHSD",
    "B00LKPM39A",
    "B07GSX78CW",
    "B0BDYWXV6L",
    "B000V2FBAQ",
    "B0B9YR7FSJ",
    "B01N1T0EGN",
    "B073YHQ5ZD",
    "B01NCP64T0",
    "B00PR2IC8I",
    "B003U4YC70",
    "B01CUF9DVY",
    "B07H9L8JRV",
    "B08VCZRLRL",
    "B07TNJRN9N",
    "B09TNLB437",
    "B096SK949M",
    "B00001R3W3",
    "B0BFWRKK8R",
    "B0040HG4AE",
    "B01N6QBJG0",
    "B07L9MBLYP",
    "B07SV4WDHK",
    "B08GZ4Z5SM",
    "B07P11F21N",
    "B01LC98QEE",
    "B0007OY3UC",
    "B07NSMQGPV",
    "B00004XP35",
    "B08GJBQMZD",
    "B07DHYH95R",
    "B00LTZEEGQ",
    "B0BJLD36TT",
    "B07GKWLBN2",
    "B08H7139X2",
    "B07S6FDHPN",
    "B0B781V95J",
    "B00LQCB6I6",
    "B0BF9PQ1YH",
    "B000JLI0K2",
    "B009NT0I06",
    "B082CCGYF1",
    "B07RT8Y122",
    "B09C5RTFRM",
    "B00LZSJ642",
    "B08TTCRD89",
    "B005FWLO44",
    "B07T86DNTD",
    "B000BQWWJK",
    "B07QF2SN7D",
    "B0BRBTFXJ5",
    "B07SMMBY4R",
    "B08ZNJBQKQ",
    "B018REM7II",
    "B0BR7MKHF9",
    "B08D1VF18M",
    "B09PQ95GY4",
    "B07C91PXNM",
    "B00GRSWXQI",
    "B07RYFWYGC",
    "B095DCY459",
    "B01BFX28R8",
    "B0064PQOSC",
    "B07TB1KW7S",
    "B0B86KKBN2",
    "B07PLLZD78",
    "B07HTFD1SG",
    "B00HX2QDV8",
    "B074KZSVD6",
    "B0B6CKG1MH",
    "B06XF4GPQP",
    "B09BMQH55C",
    "B086379CHH",
    "B08YW13SG3",
    "B01M65RD19",
    "B08K2Y2KQN",
    "B094GCJK7V",
    "194975944X",
    "B00YV5FF32",
    "B09BDQ2FRY",
    "B005PTNVM0",
    "B00WV7TQDW",
    "B0BB6Y1RJV",
    "B06Y2NHXVP",
    "B004TRKHSK",
    "B08SXLWXH9",
    "B00RSXRLUE",
    "B005W3BR2A",
    "B0883S8GW7",
    "B000SWVPV8",
    "B01MYBZ4A9",
    "B07NLL718P",
    "B01N6QPWBV",
    "B00JTF5TT4",
    "B09S77J9TX",
    "B08BFD54YW",
    "B00PA04SD0",
    "B093K7K35T",
    "B00YNSZCXA",
    "B096MLRDRZ",
    "B091BCL2YB",
    "B0C56RLLYN",
    "B07R68XHZ9",
    "B07BSWN5SP",
    "B089KL3FDD",
    "B00M3IFUMK",
    "B08NRS3YP8",
    "B078YZDW2X",
    "B0043B7UQY",
    "B0779YGB2G",
    "B07Y8PVTX5",
    "B06XGYXVXR",
    "B07R29YTRG",
    "B00BTJTYB2",
    "B00JDOCW3M",
    "B000056BAG",
    "B08883B54R",
    "B00NE4ZU5O",
    "B00PRABXFO",
    "B06W5WP5KL",
    "B08F65S419",
    "B07HC2F97Q",
    "B072N1JWJ9",
    "B0BNNYPVYR",
    "B00YR922ZG",
    "B01HF1Z5WY",
    "B00BUBAPQC",
    "B08RHR1WZK",
    "B08YDQQ6W6",
    "B00BPXN10C",
    "B081P1538H",
    "B0BP46PVVG",
    "B09MQGTP7Y",
    "B09T9DQTTR",
    "B002G24HD6",
    "B003O6E800",
    "B0001ZVXJQ",
    "B078GYC6QN",
    "B01LWM61BE",
    "B07M9BKHNZ",
    "B08MVDTLKC",
    "B07TC8J6HK",
    "B08W9C5TSQ",
    "B0798SCGQJ",
    "B07RG35NZR",
    "B00F5YTHYQ",
    "B0108L0QHM",
    "B08W7KSMVV",
    "B07T8F2RKB",
    "B007TA5QNA",
    "B08VW5974C",
    "B01KNFI86E",
    "B09FB1YXF1",
    "B01M31YZPX",
    "B00290NPTM",
    "B0BNT2LDWK",
    "B07DL2FKS2",
    "B0B6CFX35R",
    "B00DY1F2CS",
    "B000E1TJDE",
    "B08V23DZVC",
    "B01N303YPU",
    "B074G79614",
    "B01DOZRZHI",
    "B09PHP2452",
    "B0BF622HFH",
    "B01N4NTNO2",
    "B0000032ZW",
    "B07RC8KSWK",
    "B00061Q83Q",
    "B08MHZQQ56",
    "B01N7TGKYE",
    "B001Q5GOE4",
    "B0002BQMYA",
    "B093L2FJRJ",
    "B004TS06HG",
    "B000R5PKD0",
    "B001DPC4SM",
    "B0BGT56H26",
    "B00RSB6I1E",
    "B09T82QQZY",
    "B084KZ2CG1",
    "B07P7834WM",
    "B07H3NV9JS",
    "B00B3BVRHK",
    "B00UGQ1RA0",
    "B083XSZLGD",
    "B096LMV352",
    "B00NU6VN6G",
    "B004YD769C",
    "B07DG77KPX",
    "B07FL1FD47",
    "B07PDNLH8C",
    "B07XLQD1ZV",
    "B084ZBY221",
    "B08GZ3DRLW",
    "B00J5K670S",
    "B0B61KWTYP",
    "B00L2EHNJY",
    "B01NBK9GPA",
    "B08Y7C6H2F",
    "B00TGTVVMW",
    "B00SEYOWIA",
    "B01K5YKEA6",
    "B08CLD2Z4K",
    "B07RB2HTB2",
    "B07JJJGWJB",
    "B004LQSNE4",
    "B01N6QLRPU",
    "B07GC99X4K",
    "B00BG1IOC8",
    "B0B3CLP6K5",
    "B084GFNBM9",
    "B06XDPTDN5",
    "B0BJC6FMPT",
    "B00HFXBD74",
    "B00L1UEZS6",
    "B08DN2FHDY",
    "B0BZQY844F",
    "B0BF9L5CK8",
    "B01JYFHR8O",
    "B00ND0E7BW",
    "B08G4GRQYV",
    "B07D8494WV",
    "B088JVTV1K",
    "B014H8AWGC",
    "B08YJPJLFV",
    "B000F3HK78",
    "B0B12R84W3",
    "B0BLQJG2Z8",
    "B00HW2VR74",
    "B0783Q64XC",
    "B00AMAHL7S",
    "B07X7WLCJ5",
    "B09X8P426M",
    "B08BN2BL25",
    "B08P2CF98Y",
    "B09K4SG9J5",
    "B08P2FZ89X",
    "B09K4V3DHL",
    "B08P2FP52M",
    "B08P2C4FXF",
    "B08P2HGYRL",
    "B08P2D5MWP",
    "B08P2CHKY8",
    "B08P2FFQRP",
    "B00387BTJS",
    "B08P2F1WYP",
    "B08P2J1DR2",
    "B08P2F6S1Z",
    "B09K4T793W",
    "B09K4W1LXH",
    "B08P2DLZKB",
    "B08P2F6817",
    "B08BN4RFLB",
    "B0817HJ314",
    "B08P2D6T18",
    "B0817DXBQ7",
    "B08BN4QK9K",
    "B08P2DDB9Y",
    "B0009Q2PE4",
    "B09W5ZQQ1W",
    "B00KD6YW46",
    "B01JOB636K",
    "B007FHGZHS",
    "B093QJFWDX",
    "B08P2CD3QX",
    "B08BMHDYYK",
    "B08BMQVZF2",
    "B08P2D8S24",
    "B0817FGBDG",
    "B09TRTDSKM",
    "B011PK0CFQ",
    "B000COCUF2",
    "B00171PYIO",
    "B01NCZVOB3",
    "B01N9FIELY",
    "B00Q3F0ITO",
    "B01M9ISOHV",
    "B085FYHK3H",
    "B00O59SH3E",
    "B08P2GGPMW",
    "B00TWCMDQQ",
    "B09B6ZBWZH",
    "B01MSYK947",
    "B086L88DKH",
    "B091BD6KJR",
    "B09PR8NBZZ",
    "B06WW9SJ5M",
    "B08W3QKDRT",
    "B0BL4KLKK6",
    "B084TC9T4X",
    "B08LZJ8GMH",
    "B003H54TY8",
    "B00EIMRZGS",
    "B08X2HNT4D",
    "B084BGC5LR",
    "B003W0GFTU",
    "B07GW3YK17",
    "B0024396WY",
    "B01N2VB05L",
    "B00004UE4F",
    "B09V1MX8XG",
    "B0BFBNMSXS",
    "B0002GYX5K",
    "B000RSICZU",
    "B07RMK4661",
    "B09V6TBNMC",
    "B00L59D9HG",
    "B07N4BSRWR",
    "B00Q3F0GG4",
    "B00CQ7OV1E",
    "B000ARPVQ6",
    "B00KX01L28",
    "B06XXCHNM7",
    "B07YN9JXNW",
    "B000RVYRC4",
    "B09M5ZS9K5",
    "B091TVHTD3",
    "B01JVDK8K8",
    "B00C4TSVZG",
    "B09K3DBL38",
    "B017J293OU",
    "B00SYXDGPG",
    "B0BVBWCW9X",
    "B07V3G6C1F",
    "B09C6KMN6L",
    "B009I2UC3Q",
    "B0983SKFXT",
    "B000XZXE50",
    "B098HH48VX",
    "B07BKR77N6",
    "B079X4DB3J",
    "B07VJ539YP",
    "B000P0J024",
    "B0786N1335",
    "B09PSKW8LH",
    "B0B77BSPFH",
    "B01N8UJO9W",
    "B000E11220",
    "B008304KEG",
    "B0BG99WLR9",
    "B07XLVNBNB",
    "B010MHV2AC",
    "B09G1WD2CG",
    "B087B8KZLB",
    "B087CCVD5D",
    "B07RNFZ9KT",
    "B08DKVZCBC",
    "B01IABP0MI",
    "B08KVGSXFB",
    "B003ERQWD0",
    "B0BCFQY7ZY",
    "B00B2CCA6W",
    "B07NSSHPFN",
    "B017X8GL9A",
    "B071NHCKHT",
    "B01ABVLOHA",
    "B08CK9QQMH",
    "B09G61NKC3",
    "B01KYRUBT8",
    "B0BMZVSRV1",
    "B00Q4ER810",
    "B00003002L",
    "B001B9SL50",
    "B079JCLZ5C",
    "B01AO5FFIM",
    "B016TV9IOM",
    "B01MQ0IP8F",
    "1999572068",
    "B018Z6LNHE",
    "B00536OCZK",
    "B0716SP956",
    "B00O9GPEDO",
    "B08B3K9K6P",
    "B01N3489RH",
    "B08JJLVWH6",
    "B0095GVWMA",
    "B097F6916C",
    "B091NJQ29P",
    "B0B35945XG",
    "B00D7WWOES",
    "B00415UVTK",
    "B07YVTZXDT",
    "B011J54UEG",
    "B004ZN9UZO",
    "B008LXZZ4E",
    "B0044A2CK8",
    "B09V26WZ1D",
    "B001B26II4",
    "B00QW2BMH0",
    "B073BMRPCP",
    "B002Y6B4A8",
    "B08CYCDJXR",
    "B077898C1R",
    "B0B2X4BMV2",
    "B0013D53CS",
    "B01BF8DYKI",
    "B098TV2ZS3",
    "B08Y1JQZBZ",
    "B01NASUGOS",
    "B08X3JV8YR",
    "B07V6T1MH8",
    "B07F8WHNB7",
    "B0BZ3BBQ89",
    "B00K7003B4",
    "B002VLH7AW",
    "B089DLFCC1",
    "B01LYU5S6D",
    "B01BEUL5T4",
    "B078MKY7B9",
    "B07B61GLRW",
    "B01N7BTWEN",
    "B008GYYFR6",
    "B00JDOZB6C",
    "B075PTHVKN",
    "B09479VYD7",
    "B071P4PZBH",
    "B09BZZ311F",
    "B00NCAO9SO",
    "B000BRNBZ8",
    "B00HWX26G4",
    "B07L73DW8M",
    "B087R8H9XB",
    "B07L1C28N9",
    "B0B4GP9M1T",
    "B00B5U9IFC",
    "B07NBVM9PG",
    "B0BC8YRJPR",
    "B0161C43RQ",
    "B00B4H6KUM",
    "B09FK5SQGP",
    "B01MSUMVUB",
    "B09J4BP466",
    "B075MYT126",
    "B078SFLTJQ",
    "B098K7SD3P",
    "B00CKYGN3W",
    "B073NP1VGZ",
    "B09QR6MX9V",
    "B0B1LB15CH",
    "B072QN7FWK",
    "B0BVFL5NP1",
    "B077B7TYPL",
    "B091T4BM9M",
    "B01N8QNC59",
    "B07QD7KXZ8",
    "B00M0S7F8K",
    "B08CXHHLWS",
    "B01K0AOHJ4",
    "B074M13TBY",
    "B0B3DTK6YK",
    "B08WLJN3W7",
    "B07HKC1J8Q",
    "B09TC1F9GF",
    "B0BSZ23FTF",
    "B07P1GD7NK",
    "B08W63D82J",
    "B00F5P1DVA",
    "B076HCJPS4",
    "B093QDR594",
    "B0C2CCGT4Y",
    "B09B8P794R",
    "B095Y1TDNV",
    "B09X4GSGSC",
    "B0842BM7JN",
    "B08KLGWXF3",
    "B0977SFJ9H",
    "B07V3SZ43Y",
    "B09G75RWN2",
    "B01NAAWOGO",
    "B000GCS004",
    "B07CBF8ZHL",
    "B01EA91TI8",
    "B006XBSAP2",
    "B0775Z5443",
    "B07G9JMTS2",
    "B08JHP4Q82",
    "B084RNLPGR",
    "B07RNKY499",
    "B07HDK9T7B",
    "B09GYK95BL",
    "B001RNMEEE",
    "B07JZDF7JN",
    "B09THDXJ33",
    "B013M4COAE",
    "B01N33U6Y5",
    "B002L3TS5M",
    "B093CQCPTH",
    "B0002D0L5E",
    "B08CZ89J15",
    "B0786Q2RFJ",
    "B07DGGCG69",
    "B07VMXTRQ7",
    "B07KZZGNFX",
    "B071VTCWXN",
    "B09WZ4ZH5Z",
    "B00B4H6IKY",
    "B0929CDQBX",
    "B07GVXD8J2",
    "B00O1GFHQ6",
    "B00MW4H190",
    "B012BUM5V8",
    "B0045K2U0E",
    "B01MDUYET2",
    "B093TPP32X",
    "B01N5K834V",
    "B07NVVT8DF",
    "B0BV1L1TY2",
    "B07Y57WH9H",
    "B07D7HQQLH",
    "B006CVXR10",
    "B07MH34HP4",
    "B073SDKTL5",
    "B00B5VTJJ6",
    "B08DB49XRR",
    "B00I913SWE",
    "B07P2HV7XQ",
    "B07QW9159N",
    "B07LCLG1T7",
    "B0002C4GU6",
    "B091QB91X2",
    "B07HNT8SQL",
    "B09L6MPWN3",
    "B084L18WH9",
    "B0859XX6HC",
    "B01MQYAOK4",
    "B008XB1C0A",
    "B084GRS9JB",
    "B01DCYWI96",
    "B003NR57BY",
    "B089RD7F71",
    "B00LRKJV1Q",
    "B01I2MLN2Q",
    "B07342ZTT4",
    "B0BWYMYM4F",
    "B08YJ3J221",
    "B0BKRHP7H4",
    "B008AITI52",
    "B092MGLRY8",
    "B00PMKOI06",
    "B0098WV8F2",
    "B002UAKLM0",
    "B01MFGALN9",
    "B00W2D806Y",
    "B09NXS395V",
    "B00AT9Q38K",
    "B01FURLH40",
    "B09GL3VXF1",
    "B003BUCNNS",
    "B01GWBULHW",
    "B08PJNXYWB",
    "B015KY5J7Y",
    "B09BNMWJH9",
    "B00ELSOLAC",
    "B0184FR81G",
    "B0054Y0KGQ",
    "B083JVPGMY",
    "B00OS47EDK",
    "B0915CMY57",
    "B0BCMBHVWD",
    "B0053B66KE",
    "B00Z642JM2",
    "B095HZ9D8B",
    "B074K9HJRB",
    "B08FV3CTVN",
    "B0BK8SPMCL",
    "B09CZT15ZP",
    "B07CZSN425",
    "B07D42ZV9D",
    "B0BYZFY3WZ",
    "B08PW55J48",
    "B007PDBHBG",
    "B074CHCY28",
    "B07RY4RXLV",
    "B084JBLFXS",
    "B07QF4T64V",
    "B09HBYQ944",
    "B00DLLGRCA",
    "B01AB6UOW6",
    "B0010TEFFQ",
    "B08M2HRV2W",
    "B08Q82S2GD",
    "B00I51885U",
    "B00X04OKLI",
    "B00027930Y",
    "B002FTP112",
    "B013FDBGWO",
    "B07SG75NLY",
    "B00U7WKAQA",
    "B072LRHFTM",
    "B099KMZPMZ",
    "B012KCIWKA",
    "B000F09CF4",
    "B000002LV3",
    "B09NB7XNVB",
    "B075NC2MYB",
    "B005JZVJMO",
    "B003SPUIAG",
    "B088YM52MF",
    "B005ESIHZI",
    "B083T65GQX",
    "B01GJ826F8",
    "B0065M5GJ2",
    "B0129HZM7W",
    "B0B99LBSY9",
    "B00MNS2L4A",
    "B0979LJBQJ",
    "B072Q7PN7H",
    "B07PQCGMCK",
    "B009ERCFGM",
    "B005NFJAQC",
    "B01CH74RF2",
    "B01C95I8N4",
    "B086N314TX",
    "B00HSSZKAW",
    "B07JB3WQLV",
    "B005LM09QM",
    "B0773JVKNM",
    "B08JWKRGN8",
    "B08K2PR9CF",
    "B00MZD6MIE",
    "B01L4JNR0U",
    "B08C1T4KQM",
    "B007EFW3XQ",
    "B0819WNFMS",
    "B07P62MLMM",
    "B00ME3Q07S",
    "B0BF5812N3",
    "B000068G5F",
    "B0968ZWZKD",
    "B09GL2YQ2S",
    "B07B3K47LZ",
    "B07QYGXJ67",
    "B08THFYBDD",
    "B08CS7BJ18",
    "B09SMJG53B",
    "B07TW2FYNV",
    "B07HDBZN7Q",
    "B081QN6KRK",
    "B07BRC62Z4",
    "B00PP3FSDG",
    "B000HHQ7WQ",
    "B00MC8LJQ2",
    "B01MUCC1KI",
    "B07GCDKPJJ",
    "B09DNL4C9J",
    "B07MF42ZK9",
    "B07CNDCZ1C",
    "B08XWDXLGQ",
    "B00S7RZX28",
    "B07BHGT42W",
    "B07VBYH2BC",
    "B08WJPS6KY",
    "B003LZPJK2",
    "B00HXT8MNI",
    "B08WM2WLL9",
    "B07HC15QNZ",
    "B08FCXZ2N3",
    "B000002J1L",
    "B00MS7GAXE",
    "B08P7YXY4C",
    "B07JMGR536",
    "B0BV9NCWXL",
    "B000N5MK8M",
    "B0B6PWS4R5",
    "B07SM4ZM33",
    "B00VBVP30Y",
    "B0B15SP7WZ",
    "B00FIU0SCW",
    "B01NBMPHYV",
    "B00ZWMT2MS",
    "B0000CFLYJ",
    "B01GUVOXIW",
    "B0BGMJWNW7",
    "B002JI9502",
    "B07K23HV61",
    "B0005YX1NE",
    "B07SJM2PXP",
    "B00RH6R7C4",
    "B01IYBJRPK",
    "B007L5IB0I",
    "B009GQ4QSQ",
    "B07THZYFB4",
    "B0BBZ1BWTT",
    "B01BNWDLC2",
    "B004EBS16G",
    "B0BB22NF67",
    "B082J4KSKC",
    "B07Q5R22DV",
    "B07CT8QF2V",
    "B0C2QKQ2YR",
    "B07CVMY79R",
    "B0B6H1XN3F",
    "B0BQWQMQQ8",
    "B0019JDMU6",
    "B07CX9TQNY",
    "B09JVZPY8J",
    "B0BD76BTSN",
    "B07NGP9F4H",
    "B005KBZTCI",
    "B003VPC72K",
    "B014VGZQOI",
    "B0BBS1JM2X",
    "B00S8LL17E",
    "B08JVMXDP6",
    "B000LPS4BG",
    "B0BVMZNZPN",
    "B0BDPL56VF",
    "B000G7USPY",
    "B07T8JVQ4K",
    "B001NZO1DS",
    "B07SGY6WSB",
    "B08Y67HYZT",
    "B000LNB8HK",
    "B092LDK1DL",
    "B001UOW7D8",
    "B00GCAXW70",
    "B09N7ZYJKM",
    "B07XYHDMJ6",
    "B013RJCAJO",
    "B00KMV7KUU",
    "B07XG6X4TC",
    "B09MDXYS3S",
    "B07DV6VWJ4",
    "B00IS2V7LI",
    "B06WLHBBZF",
    "B001EQYYUG",
    "B09CH97KJ8",
    "B01DSZX6GI",
    "B081ZXQVFH",
    "B0BPRV5FGN",
    "B07JQZN313",
    "B08FCW2YX9",
    "B01EC4V8P0",
    "B00FEQREMW",
    "B07BMKV6MT",
    "B07HJ8MW1H",
    "B002VWNIAY",
    "B09V1KCLTX",
    "B078B5N4DD",
    "B000K41E6K",
    "B0B94RMN17",
    "B08VP1XCGK",
    "B07D859X6X",
    "B00HRVUVFY",
    "B07HGSN1TH",
    "B000F09CEA",
    "B08CVR6FPH",
    "B006NZRAFE",
    "B09K7XFFMS",
    "B00RGZ915C",
    "B002VLH874",
    "B09FBCRKC9",
    "B00UGQ3SAC",
    "B00ZGRMTLA",
    "B00FFYQ29O",
    "B0B2J5MD7N",
    "B0973JRDBR",
    "B089ZPKF16",
    "B00MG4CVAU",
    "B091NKW39H",
    "B083NFNKY2",
    "B0BX6CFWV8",
    "B099N7PJBW",
    "B0B9YSZ9D9",
    "B001UJJG46",
    "B0B9PZCY7N",
    "B00FLJIMYG",
    "B00MBVAEIO",
    "B008I3CJI2",
    "B099F7XF2Q",
    "B00IPS4KIC",
    "B08QVWDYTS",
    "B01MSD3E6M",
    "B00LFWM0H8",
    "B018209X7U",
    "B09PGXLS17",
    "B06X17LJF9",
    "B082M4MVFG",
    "B06VXJ7BQR",
    "B07VX947W1",
    "B0764Z1BX4",
    "B00ZPR8KW8",
    "B08R11D8NJ",
    "B08MDVNGJR",
    "B0000CF8Q6",
    "B00YU6C2DI",
    "B081ZFXPWY",
    "B08RMYR79C",
    "B08V79CRMH",
    "B07WMTZCBF",
    "B01LC9A6M4",
    "B0BJ7FH4MK",
    "B0036CDX12",
    "B004GDB7OA",
    "B07FPGN4L4",
    "B07FNVYGFL",
    "B00004YA66",
    "B07QZLWW4J",
    "B07MZ8ZKSR",
    "B00HK2YZ5C",
    "B005G2OJX6",
    "B017OECD7W",
    "B00N5FA6WY",
    "B074VH2VWV",
    "B00O0A7X9M",
    "B07TY8JPV9",
    "B01GEGXP0K",
    "B0741K4VDC",
    "B00RH38G7M",
    "B01MU03PEK",
    "B07PXD6C85",
    "B08FF8949Z",
    "B01MT5L2Z8",
    "B0141MQRGI",
    "B07C3CRB4S",
    "B07BHGNJ2V",
    "B0BC79C96R",
    "B07BQXYKGZ",
    "B09TQZQHX6",
    "B0B2KP6YJT",
    "B07PW9KBBJ",
    "B08ZDH9BDR",
    "B0B5SSL6FL",
    "B08RRYF52V",
    "B07J6ZZ83K",
    "B004X8GJPA",
    "B000CST0L0",
    "B000LC4ZBC",
    "B0BCWVSPW8",
    "B00UGPK8C4",
    "B07C9D8STM",
    "B07BYJF7L7",
    "B00M5GYPLM",
    "B09BDZCB7P",
    "B015G849O8",
    "B01LXC1QL0",
    "B004CH81LM",
    "B08C7PC1GM",
    "B01AGMZ20O",
    "B07289ZZVL",
    "B09FT9GF3X",
    "B07FXR67KP",
    "B0055YU240",
    "B09SV3G7GY",
    "B088P7RDRR",
    "B07JMHZMX1",
    "B00PLIQULO",
    "B09K8FH99X",
    "B07QFHZZZL",
    "B01MFXDAL8",
    "B0832BYXB2",
    "B0BHWWK431",
    "B07BPCBMRJ",
    "B07789HG6D",
    "B0BRXR325K",
    "B00CSL7NX6",
    "B00DQD63NG",
    "B086Q7Q6GJ",
    "B07HGJLHSP",
    "B079R427VR",
    "B01MSHLUN1",
    "B00AY6RO9U",
]

config_file_path = os.path.join(APP_DIR, 'source/config.json')
pid_file_path = os.path.join(APP_DIR, 'source/script_pid.json')
script_path = os.path.join(APP_DIR, 'source/main.py')

r = redis.Redis(host=os.getenv('REDIS_HOST'), port=6379, db=0, password=os.getenv('REDIS_PASSWORD'))


@after_setup_logger.connect
def setup_loggers(logger, *args, **kwargs):
    # setup your loggers
    formatter = logging.Formatter('%(asctime)s - %(message)s')
    handler = logging.FileHandler(os.path.join(APP_DIR, 'logfile.log'))
    handler.setFormatter(formatter)

    logger.addHandler(handler)
    logger.propagate = False

@shared_task
def keepa_app_fetch_model_via_redis():
    logger.info('keepa app fetch model via redis is scheduled...')
    try:
        data = r.get('keepa_data_set')
        if data is not None:
            r.delete('keepa_data_set')
            ProductService.sync_bulk_create_or_update(json.loads(data))
        else:
            logger.warning('KEEPA:No data found in Redis.')
    except redis.RedisError as e:
        logger.error(f'KEEPA:An error occurred while fetching data from Redis: {e}')
    except json.JSONDecodeError as e:
        logger.error(f'KEEPA:An error occurred while decoding JSON data from Redis: {e}')


@shared_task
def keepa_app():
    data = {
        'domain_ids': DOMAIN_IDS,
        'keepa_api': [
            {
                'is_active': True,
                'access_key': KEEPA_API_KEY,
                'tokens_per_minute': 60,
                'params': {
                    'stats': 20,
                    'buybox': 1,
                    'history': 1,
                }
            }
        ],
        'asins': PRODUCT_ASINS,
    }
    with open(config_file_path, 'w') as f:
        json.dump(data, f)
    logger.info('keepa app is running...')

    venv_python_path = os.path.join(BASE_DIR, '.venv/bin/python') if is_server else 'python3'
    is_script_running = False

    script_info = None

    if os.path.exists(pid_file_path):
        logger.info(f'{pid_file_path} exist.')
        with open(pid_file_path, 'r') as f:
            script_info = json.load(f)
            logger.info(f'{pid_file_path}: {script_info}')
    else:
        script_info = {}
        logger.info(f'{pid_file_path} does not exist.')

    for process in psutil.process_iter():
        try:
            if 'python' in process.name() and process.pid == script_info.get('pid', None) and process.create_time() == script_info.get('start_time', None):
                is_script_running = True
        except (NoSuchProcess, AccessDenied, ZombieProcess):
            pass
    

    logger.info(f'script is running: {is_script_running}')

    if not is_script_running:
        script_process = subprocess.Popen([venv_python_path, script_path], stdout=subprocess.PIPE, stderr=subprocess.STDOUT)
        script_info = {'pid': script_process.pid, 'start_time': psutil.Process(script_process.pid).create_time()}
        with open(pid_file_path, 'w') as f:
            json.dump(script_info, f)



@shared_task
def stop_keepa_app():
    if os.path.exists(pid_file_path):
        with open(pid_file_path, 'r') as f:
            pid = int(f.read().strip())
        os.kill(pid, signal.SIGTERM)
    else:
        for process in process_iter():
            try:
                for cmd in process.cmdline():
                    if script_path in cmd:
                        process.kill()
                        break
            except (NoSuchProcess, AccessDenied, ZombieProcess):
                pass


@shared_task
def restart_keepa_app():
    stop_keepa_app.delay()
    keepa_app.delay()


@shared_task
def exchangerate_request():
    url = f'https://v6.exchangerate-api.com/v6/{EXCHANGERATE_API_KEY}/latest/USD'
    response = requests.get(url)

    if response.status_code != 200:
        logger.warning(f'Error fetching exchange rates: {response.content}')
        return

    data = response.json()
    conversion_rates = data.get('conversion_rates', {})

    for code, domain in DomainExchangeRate.DOMAIN_CHOICES:
        if DomainExchangeRate.CURRENCY_CODES[domain] in conversion_rates:
            exchange_rate = conversion_rates[DomainExchangeRate.CURRENCY_CODES[domain]]
            DomainExchangeRate.objects.update_or_create(
                domain_code=code,
                defaults={'exchange_rate': exchange_rate, 'currency_code': DomainExchangeRate.CURRENCY_CODES[domain], 'domain_name': domain}
            )
            logger.info(f'Updated exchange rate for {domain}: {exchange_rate}')
        else:
            logger.warning(f'No conversion rate found for {domain}')